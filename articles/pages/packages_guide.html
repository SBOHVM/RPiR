<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RPiR">
<title>Reference - R Packages • RPiR</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Reference - R Packages">
<meta property="og:description" content="RPiR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">RPiR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.76.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--lectures-slides-">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Lectures (slides)
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--lectures-slides-">
    <a class="dropdown-item" href="../../lectures/RPiR1-intro.html">RPiR1-intro</a>
    <a class="dropdown-item" href="../../lectures/RPiR2a-R.html">RPiR2a-R</a>
    <a class="dropdown-item" href="../../lectures/RPiR2b-modelling.html">RPiR2b-modelling</a>
    <a class="dropdown-item" href="../../lectures/RPiR2c-development.html">RPiR2c-development</a>
    <a class="dropdown-item" href="../../lectures/RPiR3a-git.html">RPiR3a-git</a>
    <a class="dropdown-item" href="../../lectures/RPiR4a-R.html">RPiR4a-R</a>
    <a class="dropdown-item" href="../../lectures/RPiR4b-reporting.html">RPiR4b-reporting</a>
    <a class="dropdown-item" href="../../lectures/RPiR4c-modelling.html">RPiR4c-modelling</a>
    <a class="dropdown-item" href="../../lectures/RPiR5a-R.html">RPiR5a-R</a>
    <a class="dropdown-item" href="../../lectures/RPiR7a-R.html">RPiR7a-R</a>
    <a class="dropdown-item" href="../../lectures/RPiR8a-packages.html">RPiR8a-packages</a>
    <a class="dropdown-item" href="../../lectures/RPiR8b-randomness.pdf">RPiR8b-randomness (pdf)</a>
    <a class="dropdown-item" href="../../lectures/RPiR8c-R.html">RPiR8c-R</a>
    <a class="dropdown-item" href="../../lectures/RPiR8d-development.pdf">RPiR8d-development (pdf)</a>
    <a class="dropdown-item" href="../../lectures/RPiR11a-data.html">RPiR11a-data</a>
    <a class="dropdown-item" href="../../lectures/RPiR11b-diversity.pdf">RPiR11b-diversity (pdf)</a>
    <a class="dropdown-item" href="../../lectures/RPiR12a-programming.html">RPiR12a-programming</a>
    <a class="dropdown-item" href="../../lectures/RPiR13a-diversity.html">RPiR13a-diversity</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--lectures-html-">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Lectures (html)
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--lectures-html-">
    <a class="dropdown-item" href="../../lectures_html/RPiR1-intro.html">RPiR1-intro</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR2a-R.html">RPiR2a-R</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR2b-modelling.html">RPiR2b-modelling</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR2c-development.html">RPiR2c-development</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR3a-git.html">RPiR3a-git</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR4a-R.html">RPiR4a-R</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR4b-reporting.html">RPiR4b-reporting</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR4c-modelling.html">RPiR4c-modelling</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR5a-R.html">RPiR5a-R</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR7a-R.html">RPiR7a-R</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR8a-packages.html">RPiR8a-packages</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR8c-R.html">RPiR8c-R</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR11a-data.html">RPiR11a-data</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR12a-programming.html">RPiR12a-programming</a>
    <a class="dropdown-item" href="../../lectures_html/RPiR13a-diversity.html">RPiR13a-diversity</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--practicals-html-">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Practicals (html)
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--practicals-html-">
    <a class="dropdown-item" href="../../tutorials/practical1-6/practical1-6.html">Practical1-6</a>
    <a class="dropdown-item" href="../../tutorials/practical2-1/practical2-1.html">Practical2-1</a>
    <a class="dropdown-item" href="../../tutorials/practical2-2/practical2-2.html">Practical2-2</a>
    <a class="dropdown-item" href="../../tutorials/practical2-3/practical2-3.html">Practical2-3</a>
    <a class="dropdown-item" href="../../tutorials/practical2-4/practical2-4.html">Practical2-4</a>
    <a class="dropdown-item" href="../../tutorials/practical3-1/practical3-1.html">Practical3-1</a>
    <a class="dropdown-item" href="../../tutorials/practical3-2/practical3-2.html">Practical3-2</a>
    <a class="dropdown-item" href="../../tutorials/practical3-3/practical3-3.html">Practical3-3</a>
    <a class="dropdown-item" href="../../tutorials/practical3-4/practical3-4.html">Practical3-4</a>
    <a class="dropdown-item" href="../../tutorials/practical3-5/practical3-5.html">Practical3-5</a>
    <a class="dropdown-item" href="../../tutorials/practical3-6/practical3-6.html">Practical3-6</a>
    <a class="dropdown-item" href="../../tutorials/practical4-1/practical4-1.html">Practical4-1</a>
    <a class="dropdown-item" href="../../tutorials/practical4-2/practical4-2.html">Practical4-2</a>
    <a class="dropdown-item" href="../../tutorials/practical4-3/practical4-3.html">Practical4-3</a>
    <a class="dropdown-item" href="../../tutorials/project0/project0.html">Project-Intro</a>
    <a class="dropdown-item" href="../../tutorials/project1/project1.html">Project1</a>
    <a class="dropdown-item" href="../../tutorials/project2/project2.html">Project2</a>
    <a class="dropdown-item" href="../../tutorials/project3/project3.html">Project3</a>
    <a class="dropdown-item" href="../../tutorials/project4/project4.html">Project4</a>
    <a class="dropdown-item" href="../../tutorials/project5/project5.html">Project5</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--r">
    <span class="fas fa fas fa-laptop-code"></span>
     
    R
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--r">
    <a class="dropdown-item" href="../../articles/pages/loops.html">Loops -- for / while</a>
    <a class="dropdown-item" href="../../articles/pages/flow.html">Flow control -- if / else and comparisons</a>
    <a class="dropdown-item" href="../../articles/pages/functions.html">Functions</a>
    <a class="dropdown-item" href="../../articles/pages/devtools.html">document(), install(), and library()</a>
    <a class="dropdown-item" href="../../articles/pages/debugging.html">Debugging</a>
    <a class="dropdown-item" href="../../articles/pages/tips.html">Tips and tricks</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--guides">
    <span class="far fa far fa-file-alt"></span>
     
    Guides
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--guides">
    <a class="dropdown-item" href="../../articles/pages/preparation.html">Course preparation - R</a>
    <a class="dropdown-item" href="../../articles/pages/install_github.html">Course preparation - GitHub</a>
    <a class="dropdown-item" href="../../articles/pages/install_RPiR.html">Course preparation - RPiR</a>
    <a class="dropdown-item" href="../../articles/pages/github.html">GitHub repositories</a>
    <a class="dropdown-item" href="../../articles/pages/rstudio.html">RStudio projects and GitHub</a>
    <a class="dropdown-item" href="../../articles/pages/packages_guide.html">Create an R Package</a>
    <a class="dropdown-item" href="../../articles/pages/packages.html">Reference - R Packages</a>
    <a class="dropdown-item" href="../../articles/pages/notebooks.html">Reference - R Notebook</a>
    <a class="dropdown-item" href="../../articles/pages/reference.html">Reference - General</a>
    <a class="dropdown-item" href="../../articles/pages/vscode_liveshare.html">VS Code Live Share</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">
    <span class="fab fa fab fa-earlybirds"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SBOHVM/RPiR/discussions">
    <span class="far fa far fa-comments"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SBOHVM/RPiR/">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Reference - R Packages</h1>
            
            <h4 data-toc-skip class="date">November 16 2022</h4>
      
      
      <div class="d-none name"><code>packages_guide.Rmd</code></div>
    </div>

    
    
<p><em>Create an R package</em></p>
<p>Warning: If for any reason you can’t get
<code><a href="https://usethis.r-lib.org/reference/use_github.html" class="external-link">usethis::use_github()</a></code> to work, then skip to the end of the
page and follow the <a href="https://sbohvm.github.io/RPiR/articles/pages/packages_guide.html#alternative-setup">alternative
setup</a> instructions.</p>
<div class="section level2">
<h2 id="package-structure">Package structure<a class="anchor" aria-label="anchor" href="#package-structure"></a>
</h2>
<p>The easiest way to create an R package in RStudio is to generate one
automatically in the menus, via <span style="color: #de77ae;">File &gt;
New project… &gt; New Directory &gt; R Package</span>. Give your package
a suitably descriptive name <code>packagename</code>, remembering that
it’s good practice for the name of your repository to match the name of
your package. It’s important to be aware that the name of a package:</p>
<blockquote>
<p>“should contain only (ASCII) letters, numbers and dot, have at least
two characters and start with a letter and not end in a dot” (<a href="https://cran.r-project.org/doc/manuals/R-exts.html" class="external-link">ref</a>).</p>
</blockquote>
<p>Though very few <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html" class="external-link">package
names</a> include a dot.</p>
<p>Once you’ve picked a good name, check the box next to <span style="color: #de77ae;">Create a git repository</span>, then click on
<span style="color: #de77ae;">Create Project</span>.</p>
<p><img src="images/packages/1.png" width="100%" style="display: block; margin: auto;"></p>
<p>You should find that (1) a new RStudio project has been created
called <span style="color: #de77ae;">packagename</span>, (2) your
working directory is now <span style="color: #de77ae;">packagename</span>, and (3) inside this
directory are a number of files and directories:</p>
<p><img src="images/packages/2.png" width="100%" style="display: block; margin: auto;"></p>
<p>We’ll explore these files in due course. In the mean time, <span style="color: #de77ae;">commit</span> these files with a nice
descriptive comment, but don’t push just yet.</p>
<p><img src="images/packages/3.png" width="100%" style="display: block; margin: auto;"></p>
<p>First, we need to set up a GitHub repository and while there are a
number of ways to do this, the easiest way to connect an existing
RStudio project to GitHub is by running this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_github.html" class="external-link">use_github</a></span><span class="op">(</span>organisation <span class="op">=</span> <span class="st">"SBOHVM"</span>, private <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>This process will automatically edit your <span style="color: #de77ae;">DESCRIPTION</span> file and ask whether it’s OK
to commit these changes, so just say yes, and your GitHub repository
should open automatically in a window in your browser.</p>
<p><img src="images/packages/4.png" width="100%" style="display: block; margin: auto;"></p>
<p>We don’t have a README yet, so click <span style="color: #de77ae;">Add a README</span> and type something nice in
your README file (in your browser), then scroll down and <span style="color: #de77ae;">Commit new file</span>. Your GitHub repository
should now look something like this:</p>
<p><img src="images/packages/5.png" width="100%" style="display: block; margin: auto;"></p>
<p>and RStudio should look like this:</p>
<p><img src="images/packages/6.png" width="100%" style="display: block; margin: auto;"></p>
<p>Now that we’re connected to GitHub, click on the blue <span style="color: #de77ae;">Pull</span> arrow. When you do this, you should
see that the <span style="color: #de77ae;">README.md</span> file has
been pulled down from GitHub and is in your working directory, with
contents matching what you wrote on GitHub. Open it and confirm this for
yourself, and close that <span style="color: #de77ae;">hello.R</span>
file – it was automatically generated by RStudio and we don’t need
it.</p>
<p><img src="images/packages/7.png" width="100%" style="display: block; margin: auto;"></p>
<p>In fact, there are a few files we should delete: <span style="color: #de77ae;">R/hello.R</span>, <span style="color: #de77ae;">man/hello.Rd</span> (documentation related to
the hello.R file we don’t need), and the <span style="color: #de77ae;">NAMESPACE</span> file in the package root.</p>
<p><img src="images/packages/8.png" width="100%" style="display: block; margin: auto;"></p>
<p>Now run <code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code>. You’ll notice, in the
<span style="color: #de77ae;">Git</span> tab, <span style="color: #de77ae;">NAMESPACE</span> has changed from deleted to
modified. This is because <code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> created a
new <span style="color: #de77ae;">NAMESPACE</span> file. Why did we just
delete and recreate <span style="color: #de77ae;">NAMESPACE</span>?
Because from now on, it will be automatically populated whenever we call
<code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code>, which is only possible if we use
<code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to create a new file.</p>
<p><img src="images/packages/9.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="package-documentation">Package documentation<a class="anchor" aria-label="anchor" href="#package-documentation"></a>
</h2>
<p>Now we’re going to write some documentation for our package. To do
this we need to create a new file called <span style="color: #de77ae;">packagename-package.R</span> (replacing
<code>packagename</code> with the name of your own package). Save this
file in the <span style="color: #de77ae;">R</span> directory.</p>
<p>Once we’ve finished writing the file, we run
<code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to generate the documentation files
and <code>?packagename</code> to load the documentation into
RStudio.</p>
<p>As you can see, below:</p>
<ul>
<li>The first line is the package title</li>
<li>The second chunk of text (separated by a blank line) is the package
<strong>Description</strong>
</li>
<li>The third chunk of text (separated by a blank line) is the
<strong>Details</strong> section</li>
</ul>
<p>After that everything is labeled with a tag, so order doesn’t
matter</p>
<ul>
<li>
<code>@author</code> is <strong>Author(s)</strong>
</li>
<li>There’s no object to represent the package, so we write
<code>NULL</code> (on line 15), but manually label it with the
<code>@docType</code>, <code>@name</code>, and <code>@alias</code> tags
(lines 11-13).</li>
</ul>
<p><img src="images/packages/10.png" width="100%" style="display: block; margin: auto;"></p>
<p>The next thing we need to do is edit the <span style="color: #de77ae;">DESCRIPTION</span> file, more info <a href="https://r-pkgs.org/description.html" class="external-link">here</a>. Most of this
requires following prompts in the template. The only thing I’ve done
differently here is combine <span style="color: #de77ae;">Author</span>
and <span style="color: #de77ae;">Maintainer</span> into a single entry,
<em>i.e.</em></p>
<pre><code>Author: Who wrote it
Maintainer: The package maintainer &lt;yourself@somewhere.net&gt;</code></pre>
<p>has been changed to</p>
<pre><code><span><span class="va">Authors</span><span class="op">@</span><span class="va">R</span><span class="op">:</span> <span class="fu"><a href="https://rdrr.io/r/utils/person.html" class="external-link">person</a></span><span class="op">(</span><span class="st">"Sonia"</span>, <span class="st">"Mitchell"</span>, email <span class="op">=</span> <span class="st">"sonia.mitchell@glasgow.ac.uk"</span>,</span>
<span>                  role <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cre"</span>, <span class="st">"aut"</span><span class="op">)</span>, comment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ORCID <span class="op">=</span> <span class="st">"0000-0003-1536-2066"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>because it allows us to include more information, more info <a href="https://r-pkgs.org/description.html#author" class="external-link">here</a>.</p>
<p><img src="images/packages/11.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="functions-and-documentation">Functions and documentation<a class="anchor" aria-label="anchor" href="#functions-and-documentation"></a>
</h2>
<p>Now I’m going to add a new function (you can add any function you
like). Make sure the name of your function is the same as the file
you’re writing in and save it in the <span style="color: #de77ae;">R</span> directory. I’ve also added some
documentation above the function (details described below).</p>
<p>We can run <code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to populate the <span style="color: #de77ae;">NAMESPACE</span> and automatically generate the
documentation files in the <span style="color: #de77ae;">man</span>
directory. After which you can run <code>?my_plot</code> to look at
it.</p>
<p><img src="images/packages/12.png" width="100%" style="display: block; margin: auto;"></p>
<p>The first line is the title.</p>
<pre><code><span><span class="co">#' my_plot</span></span></code></pre>
<p>The next section (separated by a blank line) is the
<strong>Description</strong>. The description can continue onto multiple
lines so long as you don’t start writing paragraphs with blank lines
between them. This is true for all of the following examples.</p>
<pre><code><span><span class="co">#' A very simple plotting function</span></span></code></pre>
<p><strong>Usage</strong> is generated automatically from the function
itself.</p>
<p>After that everything has been labeled with a tag, so order doesn’t
really matter, but the <code>@param</code> tag is used to document the
<strong>Arguments</strong>. Note the format here is
<code>@param argument description</code>.</p>
<pre><code><span><span class="co">#' @param data \code{data.frame} containing data</span></span>
<span><span class="co">#' @param x column containing x-axis data</span></span>
<span><span class="co">#' @param y column containing y-axis data</span></span>
<span><span class="co">#' @param title \code{string} containing plot title</span></span></code></pre>
<p>The <code>@return</code> tag is used to document the output of the
function in the <strong>Value</strong> section.</p>
<pre><code><span><span class="co">#' @return Returns a \code{ggplot} object</span></span></code></pre>
<p>The <code>@export</code> tag is used to identify this function as
being exported by your package. That is, a function intended to be
usable and not internal (a function that cannot be called, but is used
internally by other functions).</p>
<pre><code><span><span class="co">#' @export</span></span></code></pre>
<p>Finally, the <code>@examples</code> tag is used to document the
<strong>Examples</strong> section. Note that here, you can use blank
lines if you want and as usual, comments are encouraged.</p>
<pre><code><span><span class="co">#' @examples</span></span>
<span><span class="co">#' # Generate data</span></span>
<span><span class="co">#' data &lt;- data.frame(R = 1:5, fun = c(1:5)^2)</span></span>
<span><span class="co">#' # Plot results</span></span>
<span><span class="co">#' my_plot(data, R, fun, "Plot showing how fun increases with R")</span></span></code></pre>
<p>We want to be able to install this function as part of our package,
but there’s one thing left to do before we can do that. Our function,
<code>my_plot()</code> is dependent on the <code>ggplot2</code> package.
That is, <code>my_plot()</code> uses functions from the
<code>ggplot2</code> package and therefore needs <code>ggplot2</code> to
be installed before it will work. We can configure our package so that
this happens automatically.</p>
</div>
<div class="section level2">
<h2 id="add-dependencies">Add dependencies<a class="anchor" aria-label="anchor" href="#add-dependencies"></a>
</h2>
<p>As mentioned previously, our <code>my_plot()</code> function is
dependent on the <code>ggplot2</code> package and so, we need to add a
dependency on <code>ggplot2</code> to our package. To do this we need to
do four things.</p>
<ol style="list-style-type: decimal">
<li>
<p>Inside the <code>my_plot()</code> function, we need to explicitly
say that <code>ggplot()</code>, <code>aes()</code>,
<code>theme_linedraw()</code>, <code>geom_point()</code>,
<code>geom_line()</code>, and <code>labs()</code> come from the
<code>ggplot2</code> package. This is done by prepending them with
<code>ggplot2::</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">{</span><span class="op">{</span> <span class="va">x</span> <span class="op">}</span><span class="op">}</span>,</span>
<span>                                     y <span class="op">=</span> <span class="op">{</span><span class="op">{</span> <span class="va">y</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</li>
<li>
<p>Add an entry in the <code>Imports</code> field of the <span style="color: #de77ae;">DESCRIPTION</span> file (lines 15-16). This can
be automated using <code>usethis::use_package("ggplot2")</code>.</p>
<p><img src="images/packages/13.png" width="100%" style="display: block; margin: auto;"></p>
<p>Note that if you need to add a dependency on a package that exists
within a GitHub repository, you can use this instead:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_package.html" class="external-link">use_dev_package</a></span><span class="op">(</span><span class="st">"RPiR"</span>, remote <span class="op">=</span> <span class="st">"SBOHVM/RPiR"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Add an <code>@import</code> tag to the <span style="color: #de77ae;">packagename-package.R</span> file (see line
15).</p>
<p><img src="images/packages/14.png" width="100%" style="display: block; margin: auto;"></p>
</li>
<li><p>Run <code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to populate the <span style="color: #de77ae;">NAMESPACE</span> file from the
<code>@import</code> tag in <span style="color: #de77ae;">packagename-package.R</span>. Note that you
should never edit <span style="color: #de77ae;">NAMESPACE</span> by
hand.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="add-a-demo">Add a demo<a class="anchor" aria-label="anchor" href="#add-a-demo"></a>
</h2>
<p>The last thing we’re going to do is add a demo file. To do that we
need to add a <span style="color: #de77ae;">demo</span> directory to the
package root. This is where the demos live.</p>
<p>Next we need to create a <span style="color: #de77ae;">00Index</span>
file (with no file extension) inside the <span style="color: #de77ae;">demo</span> directory. This file must list the
names of the demos installed as part of your package. The file itself
should look something like this:</p>
<pre><code>my_demo   A simple demo
</code></pre>
<p>Note that each entry should be written on a new line, in a standard
format. That is, the name of the demo (it’s filename), followed by (at
least) three spaces, followed by a simple description. Also note the
empty line at the end of the file.</p>
<p>Now we’re going to add a demo, which is a standard R file (in this
case including a little R markdown).</p>
<blockquote>
<p>The important thing to note here is that you no longer need to
<code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> files, since any functions you need to use can be
installed as part of the package.</p>
</blockquote>
<p><img src="images/packages/15.png" width="100%" style="display: block; margin: auto;"></p>
<p>Next, we need to install our package using
<code><a href="https://devtools.r-lib.org/reference/install.html" class="external-link">devtools::install()</a></code>.</p>
<p>After which, we can run <code>demo(package = "packagename")</code> to
list all of the demos in our package, or
<code>demo("my_demo", package = "packagename")</code> to run the
<code>my_demo</code> demo.</p>
</div>
<div class="section level2">
<h2 id="add-data">Add data<a class="anchor" aria-label="anchor" href="#add-data"></a>
</h2>
<p>The next thing we’re going to do is add data to our package. To do
this, run <code>usethis::use_data_raw("BCI")</code>. This will create a
new directory, called <code>data-raw</code> and within it a file called
<span style="color: #de77ae;">BCI.R</span>. We should put our raw,
unedited data in this directory. Any code we use to process our data
should be written in <span style="color: #de77ae;">BCI.R</span>. The
processing file should end up looking something like this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## code to prepare `BCI` dataset goes here</span></span>
<span></span>
<span><span class="co"># Read the data</span></span>
<span><span class="va">raw.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data-raw/myrawdata.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Process the data</span></span>
<span><span class="va">BCI</span> <span class="op">&lt;-</span> <span class="fu">some_tidying_process</span><span class="op">(</span><span class="va">raw.data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add the data to your package</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data</a></span><span class="op">(</span><span class="va">BCI</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Next we need to generate the packaged data by running the processing
script. The <code><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data()</a></code> function will create a <span style="color: #de77ae;">data</span> directory, within which will be an
rds file containing our dataset.</p>
<p>The next step is to open our <span style="color: #de77ae;">.gitignore</span> file and add
<code>data-raw</code> on a new line to ignore the contents of this
directory. The reason being, the contents of <span style="color: #de77ae;">data-raw</span> are not part of the package
(installable data exists within your <span style="color: #de77ae;">data</span> directory) and we don’t want to
upload these large files to GitHub.</p>
<p>Next we should document our data (more info <a href="https://r-pkgs.org/data.html" class="external-link">here</a> and <a href="https://kbroman.org/pkg_primer/pages/data.html" class="external-link">here</a>). To do
that, we need to create a <span style="color: #de77ae;">data.R</span>
file in the <span style="color: #de77ae;">R</span> directory. It should
look something like this:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' mydataset</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' Description of mydataset</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @docType data</span></span>
<span><span class="co">#' @usage data(mydataset)</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @format A data frame with x rows and y variables:</span></span>
<span><span class="co">#' \describe{</span></span>
<span><span class="co">#'   \item{variable1}{description}</span></span>
<span><span class="co">#'   \item{variabl2}{description}</span></span>
<span><span class="co">#'   ...</span></span>
<span><span class="co">#' }</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @source \url{http://somewhere.important.com/}</span></span>
<span><span class="st">"mydataset"</span></span></code></pre></div>
<p>As usual, we need to run <code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to
automatically generate the documentation files and then
<code><a href="https://devtools.r-lib.org/reference/install.html" class="external-link">devtools::install()</a></code> to install our package.</p>
<p>After which, we can run <code>data(package = "packagename")</code> to
list all of the data in our package.</p>
</div>
<div class="section level2">
<h2 id="alternative-setup">Alternative setup<a class="anchor" aria-label="anchor" href="#alternative-setup"></a>
</h2>
<p>If for any reason you can’t get <code><a href="https://usethis.r-lib.org/reference/use_github.html" class="external-link">usethis::use_github()</a></code> to
work, then follow these <a href="https://sbohvm.github.io/RPiR/articles/pages/github.html">instructions</a>
to create a repository on GitHub with a <span style="color: #de77ae;">README</span> file. Remember that the name of
your repository should match the name of your package and be aware that
the name of your package:</p>
<blockquote>
<p>“should contain only (ASCII) letters, numbers and dot, have at least
two characters and start with a letter and not end in a dot” (<a href="https://cran.r-project.org/doc/manuals/R-exts.html" class="external-link">ref</a>).</p>
</blockquote>
<p>Though very few <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html" class="external-link">package
names</a> include a dot. In the following example, the name of our
repository (and package) is <code>packagename</code>.</p>
<p>Once you have a repository on GitHub, follow these <a href="https://sbohvm.github.io/RPiR/articles/pages/rstudio.html">instructions</a>
to clone your repository and add it as a new project in RStudio. Then
create the package structure by running:</p>
<pre><code><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_package.html" class="external-link">create_package</a></span><span class="op">(</span><span class="st">"structure"</span><span class="op">)</span></span></code></pre>
<p>at which point you’ll get a warning saying you shouldn’t really be
nesting RStudio projects inside each other. Ignore that and say yes, you
want to continue. You’ll end up with a file structure that looks a bit
like this:</p>
<pre><code>packagename/ ---&gt; .gitignore
                  README.md
                  packagename.Rproj
                  structure/        ---&gt; .gitignore 
                                         .Rbuildignore
                                         DESCRIPTION
                                         NAMESPACE
                                         structure.Rproj
                                         R/
                                         </code></pre>
<p>Take everything in the <span style="color: #de77ae;">structure</span>
directory except for the <span style="color: #de77ae;">structure.Rproj</span> and <span style="color: #de77ae;">.gitignore</span> files and put it in the <span style="color: #de77ae;">packagename</span> directory. Now delete the
<span style="color: #de77ae;">structure</span> directory and move to the
<span style="color: #de77ae;">packagename</span> project in RStudio.
Once you’ve done that, create an empty directory within <span style="color: #de77ae;">packagename</span> called <span style="color: #de77ae;">man</span>. Your file structure should now look
like this:</p>
<pre><code>packagename/ ---&gt; .gitignore
                  README.md
                  packagename.Rproj
                  .Rbuildignore
                  DESCRIPTION
                  NAMESPACE
                  R/
                  man/</code></pre>
<p>Finally, delete the <span style="color: #de77ae;">NAMESPACE
file</span> and run <code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to create a new
<span style="color: #de77ae;">NAMESPACE</span> file. Why did we just
delete and recreate <span style="color: #de77ae;">NAMESPACE</span>?
Because from now on, it will be automatically populated whenever we call
<code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code>, which is only possible if we use
<code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to create a new file. Also, don’t
forget to keep pushing your changes to GitHub.</p>
<p>You can now rejoin the instructions above <a href="https://sbohvm.github.io/RPiR/articles/pages/packages_guide.html#package-documentation">here</a>.</p>
</div>
<div class="section level2">
<h2 id="final-thoughts">Final thoughts<a class="anchor" aria-label="anchor" href="#final-thoughts"></a>
</h2>
<p>If you get stuck and need to troubleshoot your package, try running
<code><a href="https://devtools.r-lib.org/reference/check.html" class="external-link">devtools::check()</a></code>. This will build your package in a clean
environment and potentially highlight any issues that might be causing
problems.</p>
<p>Whenever you make a change to your package (particularly when you’re
pushing to GitHub), you should try to get into the habit of changing the
version number. This is important because it allows you to keep track of
which version of the code is being used in a particular analysis. The
format is usually <strong>major.minor.patch</strong>, more info <a href="https://semver.org" class="external-link">here</a>.</p>
<p>The version of your package is recorded in the <span style="color: #de77ae;">DESCRIPTION</span> file, like this:</p>
<pre><code>Version: 0.1.0</code></pre>
<p>Here, we have added more than enough to warrant increasing version
number from <code>0.1.0</code> to <code>0.2.0</code>, so do that now.
Remember to push this change to GitHub too.</p>
</div>
<div class="section level2">
<h2 id="sharing-is-caring">Sharing is caring<a class="anchor" aria-label="anchor" href="#sharing-is-caring"></a>
</h2>
<p>The only thing left to do now is to share your package with other
people. So go ahead and give them access (on the GitHub website, <span style="color: #de77ae;">Settings &gt; Manage access &gt; Invite teams or
people</span>).</p>
<p>Then ask them to run:</p>
<pre><code><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"SBOHVM/packagename"</span><span class="op">)</span></span></code></pre>
<p>Go ahead and try to install my package. Try to run the demo.</p>
<p>Note that if for some reason you can’t install a package using
<code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github()</a></code>, you can clone a repository as you did <a href="https://sbohvm.github.io/RPiR/articles/pages/rstudio.html">here</a>
and instead run <code><a href="https://devtools.r-lib.org/reference/install.html" class="external-link">devtools::install()</a></code> in the usual way.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sonia Mitchell, Richard Reeve.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
