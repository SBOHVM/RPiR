<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Practical A-5: Nested functions</title>

<!-- HEAD_CONTENT -->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="section-header">



<h1 class="title toc-ignore">Practical A-5: Nested functions</h1>

</div>


<div id="section-introduction" class="section level2">
<h2>Introduction</h2>
<p>If you have a complex piece of code that does a single discrete
thing, then you may want to wrap it up into a function so that you can
refer to it by a simple name and keep the script that calls it clear and
easy to read. However, you may also want to do simpler versions of that
more complex task. You can either write a completely separate function
to carry out that task – but that would be breaking our guidance about
copying code back and forth – or you can write a short and simple
function that doesn’t do the hard (and duplicated) work itself, but
instead just calls your more complex function, perhaps with simplified
arguments.</p>
<blockquote>
<p>Note, you will also see all of this code on GitHub at <a
href="https://github.com/SBOHVM/practicalA5"
class="uri">https://github.com/SBOHVM/practicalA5</a> if you want to
look at it there instead, or you can install it locally on your computer
using <code>devtools::install_github("SBOHVM/practicalA5")</code> and
play with the functions. Or you can download it by cloning the git repo
at <code>https://github.com/SBOHVM/practicalA5.git</code>.</p>
</blockquote>
</div>
<div id="section-functions" class="section level2">
<h2>Functions</h2>
<p>Imagine we’d written a really cool function that solves a complex
task… well, here just one that multiple two numbers together, adds a
third and then raises the result to a power:</p>
<pre class="r"><code>muladdpow &lt;- function(value, m, a, p) {
  ma &lt;- value * m + a
  ma ^ p
}

muladdpow(1, 2, 3, 2)
&gt; [1] 25</code></pre>
<p>Try running the code block. Play with the arguments and rerun it to
see how it works. Now try to write a function that uses this function,
but only does the multiply and add part, so you just get
<code>value * m + a</code> back at the end:</p>
<pre class="r"><code>muladd &lt;- function(value, m, a) {
  muladdpow(value, m, a, ____)
}

muladd(2, 3, 4) == 10
&gt; Error: &lt;text&gt;:2:27: unexpected input
&gt; 1: muladd &lt;- function(value, m, a) {
&gt; 2:   muladdpow(value, m, a, __
&gt;                              ^</code></pre>
<pre class="r"><code>muladd &lt;- function(value, m, a) {
  muladdpow(value, m, a, 1)
}

muladd(2, 3, 4) == 10
&gt; [1] TRUE</code></pre>
<pre class="r"><code>grade_this_code()
&gt; function (check_env) 
&gt; {
&gt;     if (is_empty_code(check_env[[&quot;.user_code&quot;]])) {
&gt;         return(grade_code_is_empty())
&gt;     }
&gt;     check_env[[&quot;.__correct&quot;]] &lt;- correct
&gt;     check_env[[&quot;.__incorrect&quot;]] &lt;- incorrect
&gt;     check_env[[&quot;.__action&quot;]] &lt;- action
&gt;     grade &lt;- with_options(list(gradethis.allow_partial_matching = allow_partial_matching, 
&gt;         gradethis.maybe_code_feedback = TRUE), grade_this({
&gt;         .message &lt;- code_feedback()
&gt;         if (is.null(.message)) {
&gt;             if (&quot;pass&quot; %in% get(&quot;.__action&quot;)) {
&gt;                 pass(get(&quot;.__correct&quot;))
&gt;             }
&gt;         }
&gt;         else {
&gt;             if (&quot;fail&quot; %in% get(&quot;.__action&quot;)) {
&gt;                 fail(get(&quot;.__incorrect&quot;), hint = FALSE)
&gt;             }
&gt;         }
&gt;         invisible(NULL)
&gt;     })(check_env))
&gt;     if (is.null(grade)) {
&gt;         return(invisible(NULL))
&gt;     }
&gt;     class(grade) &lt;- c(&quot;gradethis_graded_this_code&quot;, class(grade))
&gt;     grade
&gt; }
&gt; &lt;bytecode: 0x55fa547ac5c8&gt;
&gt; &lt;environment: 0x55fa5ab92fe8&gt;</code></pre>
<p>Then write a function <code>mul()</code> that uses
<code>muladd()</code> but just multiplies two numbers together, ignoring
the addition:</p>
<pre class="r"><code>mul &lt;- function(value, m) {
  muladd(____)
}

mul(2, 3) == 6
&gt; Error: &lt;text&gt;:2:11: unexpected input
&gt; 1: mul &lt;- function(value, m) {
&gt; 2:   muladd(__
&gt;              ^</code></pre>
<pre class="r"><code>mul &lt;- function(value, m) {
  muladd(value, m, 0)
}

mul(2, 3) == 6
&gt; [1] TRUE</code></pre>
<pre class="r"><code>grade_this_code()
&gt; function (check_env) 
&gt; {
&gt;     if (is_empty_code(check_env[[&quot;.user_code&quot;]])) {
&gt;         return(grade_code_is_empty())
&gt;     }
&gt;     check_env[[&quot;.__correct&quot;]] &lt;- correct
&gt;     check_env[[&quot;.__incorrect&quot;]] &lt;- incorrect
&gt;     check_env[[&quot;.__action&quot;]] &lt;- action
&gt;     grade &lt;- with_options(list(gradethis.allow_partial_matching = allow_partial_matching, 
&gt;         gradethis.maybe_code_feedback = TRUE), grade_this({
&gt;         .message &lt;- code_feedback()
&gt;         if (is.null(.message)) {
&gt;             if (&quot;pass&quot; %in% get(&quot;.__action&quot;)) {
&gt;                 pass(get(&quot;.__correct&quot;))
&gt;             }
&gt;         }
&gt;         else {
&gt;             if (&quot;fail&quot; %in% get(&quot;.__action&quot;)) {
&gt;                 fail(get(&quot;.__incorrect&quot;), hint = FALSE)
&gt;             }
&gt;         }
&gt;         invisible(NULL)
&gt;     })(check_env))
&gt;     if (is.null(grade)) {
&gt;         return(invisible(NULL))
&gt;     }
&gt;     class(grade) &lt;- c(&quot;gradethis_graded_this_code&quot;, class(grade))
&gt;     grade
&gt; }
&gt; &lt;bytecode: 0x55fa547ac5c8&gt;
&gt; &lt;environment: 0x55fa5b1142a0&gt;</code></pre>
<p>Finally, write a function <code>tripler() that uses</code>mul()` but
always multiples by three:</p>
<pre class="r"><code>tripler &lt;- function(value) {
  ____
}

tripler(2) == 6
&gt; Error: &lt;text&gt;:2:4: unexpected input
&gt; 1: tripler &lt;- function(value) {
&gt; 2:   __
&gt;       ^</code></pre>
<pre class="r"><code>tripler &lt;- function(value) {
  mul(value, 3)
}

tripler(2) == 6
&gt; [1] TRUE</code></pre>
<pre class="r"><code>grade_this_code()
&gt; function (check_env) 
&gt; {
&gt;     if (is_empty_code(check_env[[&quot;.user_code&quot;]])) {
&gt;         return(grade_code_is_empty())
&gt;     }
&gt;     check_env[[&quot;.__correct&quot;]] &lt;- correct
&gt;     check_env[[&quot;.__incorrect&quot;]] &lt;- incorrect
&gt;     check_env[[&quot;.__action&quot;]] &lt;- action
&gt;     grade &lt;- with_options(list(gradethis.allow_partial_matching = allow_partial_matching, 
&gt;         gradethis.maybe_code_feedback = TRUE), grade_this({
&gt;         .message &lt;- code_feedback()
&gt;         if (is.null(.message)) {
&gt;             if (&quot;pass&quot; %in% get(&quot;.__action&quot;)) {
&gt;                 pass(get(&quot;.__correct&quot;))
&gt;             }
&gt;         }
&gt;         else {
&gt;             if (&quot;fail&quot; %in% get(&quot;.__action&quot;)) {
&gt;                 fail(get(&quot;.__incorrect&quot;), hint = FALSE)
&gt;             }
&gt;         }
&gt;         invisible(NULL)
&gt;     })(check_env))
&gt;     if (is.null(grade)) {
&gt;         return(invisible(NULL))
&gt;     }
&gt;     class(grade) &lt;- c(&quot;gradethis_graded_this_code&quot;, class(grade))
&gt;     grade
&gt; }
&gt; &lt;bytecode: 0x55fa547ac5c8&gt;
&gt; &lt;environment: 0x55fa5609ede8&gt;</code></pre>

<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
tutorial_options(exercise.reveal_solution = FALSE)
gradethis::gradethis_setup()

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = ">",
  error = TRUE
)
set.seed(123)

muladdpow <- function(value, m, a, p) {
  ma <- value * m + a
  ma ^ p
}

muladd <- function(value, m, a) {
  muladdpow(value, m, a, 1)
}

mul <- function(value, m) {
  muladd(value, m, 0)
}
</script>

<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.18"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.18"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.18"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.18"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.18"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87]}},"value":[{"type":"character","attributes":{},"value":["backports","base","bslib","cachem","callr","checkmate","cli","codetools","colorspace","commonmark","compiler","crayon","curl","datasets","deSolve","devtools","digest","dplyr","ellipsis","evaluate","fansi","fastmap","fs","generics","ggplot2","glue","gradethis","graphics","grDevices","grid","gtable","here","highr","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","learnr","lifecycle","magrittr","markdown","MASS","memoise","methods","mime","miniUI","munsell","pillar","pkgbuild","pkgconfig","pkgload","prettyunits","processx","profvis","promises","ps","purrr","R6","Rcpp","remotes","rlang","rmarkdown","RPiR","rprojroot","rstudioapi","sass","scales","sessioninfo","shiny","stats","stringi","stringr","tibble","tidyselect","tools","urlchecker","usethis","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.4.1","4.2.2","0.4.1","1.0.6","3.7.3","2.1.0","3.4.1","0.2-18","2.0-3","1.8.1","4.2.2","1.5.2","4.3.3","4.2.2","1.34","2.4.5","0.6.31","1.0.10","0.3.2","0.19","1.0.3","1.1.0","1.5.2","0.1.3","3.4.0","1.6.2","0.2.11.9000","4.2.2","4.2.2","4.2.2","0.3.1","1.0.1","0.9","0.5.4","1.5.4","1.6.6","0.1.4","1.8.4","1.41","1.3.0","0.11.2.9000","1.0.3","2.0.3","1.4","7.3-58.1","2.0.1","4.2.2","0.12","0.1.1.1","0.5.0","1.8.1","1.4.0","2.0.3","1.3.2","1.1.1","3.8.0","0.3.7","1.2.0.1","1.7.2","0.3.5","2.5.1","1.0.9","2.4.2","1.0.6","2.18","0.76.30","2.0.3","0.14","0.4.4","1.2.1","1.2.2","1.7.3","4.2.2","1.7.8","1.5.0","3.1.8","1.2.0","4.2.2","1.0.1","2.1.6","1.2.2","4.2.2","0.5.1","2.5.0","0.35","1.8-4","2.3.6"]}]}]}
</script>
<!--/html_preserve-->
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
