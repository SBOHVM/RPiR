<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Practical A-2: Functions</title>

<!-- HEAD_CONTENT -->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="section-header">



<h1 class="title toc-ignore">Practical A-2: Functions</h1>

</div>


<div id="section-introduction" class="section level2">
<h2>Introduction</h2>
<p>Functions allow you to repeat the same task multiple times, but potentially in multiple places on different data. If you have a complex piece of code that does a single discrete thing, then you may want to wrap it up into a function so that you can refer to it by a simple name and keep the script that calls it clear and easy to read.</p>
<p>To quote from <a href="https://r4ds.had.co.nz/functions.html">the introduction to R4DS on functions</a>:</p>
<blockquote>
<p>One of the best ways to improve your reach as a data scientist is to write functions. Functions allow you to automate common tasks in a more powerful and general way than copy-and-pasting. Writing a function has three big advantages over using copy-and-paste:</p>
<ol style="list-style-type: decimal">
<li><p>You can give a function an evocative name that makes your code easier to understand.</p></li>
<li><p>As requirements change, you only need to update code in one place, instead of many.</p></li>
<li><p>You eliminate the chance of making incidental mistakes when you copy and paste (i.e. updating a variable name in one place, but not in another).</p></li>
</ol>
</blockquote>
<p>Functions allow us to wrap up a common task into a single line of code, irrespective of how complex and long the code chunk is, making our scripts cleaner and easier to read. They allow us to describe what the code is doing (by assigning a name to the function), making our scripts easier to understand. Finally, writing custom functions rather than duplicating code means that there is only a single place that needs to be checked for correctness, rather than having to remember all of the places your duplicated (likely copied and pasted) code exists.</p>
</div>
<div id="section-functions" class="section level2">
<h2>Functions</h2>
<p>It’s very easy to write a function. Here we write a single function (called <code>function_name</code>), that takes one input (we call the inputs to functions <em>arguments</em>, here there is just one called <code>argument</code>). Finally, whatever appears last in the function definition will be returned to the script that calls it, in this case, <code>result</code>.</p>
<p>Every function has one “line” of code after it (comments are ignored) that defines what the function does. Because nearly all functions need multiple lines to define what they do, we nearly always use matching curly brackets - <code>{ ... }</code> - to allow us to wrap multiple commands that are all treated as one line by R:</p>
<pre class="r"><code>function_name &lt;- function(argument) {
  # Function body
  
  # ... exciting code using argument
  #     to do something useful, and
  #     producing some result ...
  result
}</code></pre>
<p>Above, we just have dummy code, and it doesn’t work. Note that the <em>function body</em>, the code that gets run when you use the function is wrapped in curly brackets <code>{ ... }</code> - this makes it possible for the computer to know what is supposed to be in the function and what isn’t.</p>
<p>Now we can write a couple of very simple functions that really do something (not very exciting!):</p>
<pre class="r"><code>add_one &lt;- function(number) {
  number + 1
}

add_one(10)
&gt; [1] 11</code></pre>
<p>Try running the code block. Can you see what it does? Feel free to change the argument from <code>10</code> to a different value to make sure it works as expected. And change what the function does if you like - when you do, change the name though, so it makes sense… it’s really important for your functions to have good names so it’s easy to tell if you’re using them right. Note that because <code>add_one(10)</code> is called after you close the curly bracket, it’s not considered part of the function, it’s in your main script.</p>
<p>The last (and indeed only) line of code in this function is what is returned by the function, here just the number plus one. <strong>It’s critical that the last line of your function has the value you want to return in it.</strong> Normally we need to do something more complex in our function - here we make a calculation and then return it on the last line (possibly the second simplest thing we could do):</p>
<pre class="r"><code>add_one &lt;- function(number) {
  one.more &lt;- number + 1
  one.more
}

add_one(10)
&gt; [1] 11</code></pre>
<p>Check that this does the same job. <em>Example 1</em> may seem simpler. However, it’s usually helpful when writing functions to name the thing that you calculate to make it easier to keep track of what’s going on. You can then return the variable (in <em>Example 2</em>, <code>one.more</code>) that you have just calculated.</p>
<p>Try running the next code chunk:</p>
<pre class="r"><code>add_one &lt;- function(number) {
  one.more &lt;- number + 1
  one.more
}

add_one(10)
&gt; [1] 11
one.more
&gt; Error in eval(expr, envir, enclos): object &#39;one.more&#39; not found</code></pre>
<pre class="r"><code>add_one &lt;- function(number) {
  one.more &lt;- number + 1
  one.more
}

one.more &lt;- 20
add_one(10)
&gt; [1] 11
one.more
&gt; [1] 20</code></pre>
<pre class="r"><code>grade_this_code()
&gt; function (check_env) 
&gt; {
&gt;     check_env[[&quot;.__correct&quot;]] &lt;- correct
&gt;     check_env[[&quot;.__incorrect&quot;]] &lt;- incorrect
&gt;     grade &lt;- with_options(list(gradethis.allow_partial_matching = allow_partial_matching, 
&gt;         gradethis.maybe_code_feedback = TRUE), grade_this({
&gt;         .message &lt;- code_feedback()
&gt;         if (is.null(.message)) {
&gt;             pass(get(&quot;.__correct&quot;))
&gt;         }
&gt;         fail(get(&quot;.__incorrect&quot;))
&gt;     })(check_env))
&gt;     class(grade) &lt;- c(&quot;gradethis_graded_this_code&quot;, class(grade))
&gt;     grade
&gt; }
&gt; &lt;bytecode: 0x7f80c9eb59c0&gt;
&gt; &lt;environment: 0x7f80c7650cc0&gt;</code></pre>
<p>You’ll see that it gives an error. That is because, although you have calculated <code>one.more</code> inside the function, it is discarded when the function ends. This is because variables defined inside functions are <em>local</em> to the function. For there to be a variable in your main script called one.more, you need to define it there. Try adding a line of code between lines 5 and 6 of <em>Exercise 1</em> that just says:</p>
<pre class="r"><code>one.more &lt;- 20</code></pre>
<p>Note that the <em>global</em> <code>one.more</code> variable (the one in your main script) is not affected by calling the <code>add_one()</code> function even though it looks like it is updated there.</p>
</div>
<div id="section-exercise" class="section level2">
<h2>Exercise</h2>
<p>This function is intended to subtract two numbers, returning the calculated value, whilst also checking whether or not the result is negative. Try to fix the mistake in the code.</p>
<pre class="r"><code>subtract &lt;- function(first, second) {
  # Calculate the result
  subtracted &lt;- first - second
  # And return it
  subtracted
  # Check whether result is negative
  if (subtracted &lt; 0) 
    print(&quot;Negative number&quot;)
}

# Call the function to subtract 5 from 3
subtract(3, 5)
&gt; [1] &quot;Negative number&quot;</code></pre>
<pre class="r"><code>subtract &lt;- function(first, second) {
  # Calculate the result
  subtracted &lt;- first - second
  # Check whether result is negative
  if (subtracted &lt; 0) 
    print(&quot;Negative number&quot;)
  # And return it
  subtracted
}

# Call the function to subtract 5 from 3
subtract(3, 5)
&gt; [1] &quot;Negative number&quot;
&gt; [1] -2</code></pre>
<pre class="r"><code>grade_this_code()
&gt; function (check_env) 
&gt; {
&gt;     check_env[[&quot;.__correct&quot;]] &lt;- correct
&gt;     check_env[[&quot;.__incorrect&quot;]] &lt;- incorrect
&gt;     grade &lt;- with_options(list(gradethis.allow_partial_matching = allow_partial_matching, 
&gt;         gradethis.maybe_code_feedback = TRUE), grade_this({
&gt;         .message &lt;- code_feedback()
&gt;         if (is.null(.message)) {
&gt;             pass(get(&quot;.__correct&quot;))
&gt;         }
&gt;         fail(get(&quot;.__incorrect&quot;))
&gt;     })(check_env))
&gt;     class(grade) &lt;- c(&quot;gradethis_graded_this_code&quot;, class(grade))
&gt;     grade
&gt; }
&gt; &lt;bytecode: 0x7f80c9eb59c0&gt;
&gt; &lt;environment: 0x7f80c74b6880&gt;</code></pre>

<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
tutorial_options(exercise.reveal_solution = FALSE)
gradethis::gradethis_setup()

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = ">",
  error = TRUE
)
set.seed(123)
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84]}},"value":[{"type":"character","attributes":{},"value":["backports","base","bslib","cachem","callr","checkmate","cli","codetools","colorspace","compiler","crayon","curl","datasets","desc","deSolve","devtools","digest","dplyr","ellipsis","evaluate","fansi","fastmap","fs","generics","ggplot2","glue","gradethis","graphics","grDevices","grid","gtable","highr","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","learnr","lifecycle","magrittr","markdown","MASS","memoise","methods","mime","munsell","pillar","pkgbuild","pkgconfig","pkgload","prettyunits","processx","promises","ps","purrr","R6","Rcpp","remotes","rlang","rmarkdown","RPiR","rprojroot","rstudioapi","sass","scales","sessioninfo","shiny","stats","stringi","stringr","testthat","tibble","tidyselect","tools","usethis","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.4.0","4.1.2","0.3.1","1.0.6","3.7.0","2.0.0","3.1.0","0.2-18","2.0-2","4.1.2","1.4.2","4.3.2","4.1.2","1.4.0","1.30","2.4.3","0.6.29","1.0.7","0.3.2","0.14","0.5.0","1.1.0","1.5.2","0.1.1","3.3.5","1.5.1","0.2.4.9000","4.1.2","4.1.2","4.1.2","0.3.0","0.9","0.5.2","1.5.4","1.6.3","0.1.4","1.7.2","1.36","1.3.0","0.10.1.9017","1.0.1","2.0.1","1.1","7.3-54","2.0.1","4.1.2","0.12","0.5.0","1.6.4","1.3.0","2.0.3","1.2.4","1.1.1","3.5.2","1.2.0.1","1.6.0","0.3.4","2.5.1","1.0.7","2.4.2","0.4.12","2.11","0.74.0","2.0.2","0.13","0.4.0","1.1.1","1.2.2","1.7.1","4.1.2","1.7.6","1.4.0","3.1.1","3.1.6","1.1.1","4.1.2","2.1.5","1.2.2","4.1.2","0.3.8","2.4.3","0.28","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
