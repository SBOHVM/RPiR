<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Practical 1-6: Writing a report in RStudio</title>

<!-- HEAD_CONTENT -->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="section-header">



<h1 class="title toc-ignore">Practical 1-6: Writing a report in RStudio</h1>

</div>


<div id="section-overview" class="section level2">
<h2>Overview</h2>
<p><em>In this practical we will look at GitHub and RStudio projects as a means to organise your workflow. Furthermore, we will take the code for the models with just growth (Practical 1-4) and with births and deaths (Practical 1-5) and make a clearer report comparing the two.</em></p>
<hr />
<p>Note that from here on out you will be working in RStudio. If you don’t still have it open, you should be able to open the new project that you created in Practical 1-1 using <span style="color: #dd1c77;">File &gt; Open Project in New Session…</span> in RStudio or follow the instructions in 1-1 to create another new project if you want to do that.</p>
<p>To access course materials, you have two options:</p>
<ol style="list-style-type: decimal">
<li><p>If you choose to run the course using <code>run_practical()</code>, you should notice a big red stop button in the corner of the <span style="color: #dd1c77;">Console</span> tab. This will prevent you from being able to run anything else in this instance of RStudio. You should therefore open a second instance of RStudio to run your code.</p></li>
<li><p>You can instead access the course materials from a new tab, which will run in the background. In RStudio, click <span style="color: #dd1c77;">View &gt; Panes &gt; Pane Layout…</span> then in the <span style="color: #dd1c77;">Files, Plots, Packages, Help, Viewer</span> section, scroll down and check the box next to <span style="color: #dd1c77;">Tutorial</span>. This will give you a tutorial tab from which to access materials. You can then click <span style="color: #dd1c77;">Show in new window</span> (next to the tiny icon of a house) to make the window larger. You should be able to run your code in the same instance of RStudio without any problems.</p></li>
</ol>
</div>
<div id="section-github" class="section level2">
<h2>GitHub</h2>
<p>First you’ll need to create a repository in the IBAHCM organisation on GitHub. You’ll find instructions on how to do this <a href="https://ibahcm.github.io/RPiR/articles/pages/use_github.html">here</a>. Note that you’ll need to do this throughout this course, which is why we’ve kept these instructions separate.</p>
<p>After you’ve done that, back in RStudio, load the <code>RPiR</code> package and run the <code>practical_series_one()</code> function. This will populate your working directory – and therefore your RStudio project – with the scripts and functions from Practical Series 1. Remember that the yellow question mark in the <span style="color: #dd1c77;">Status</span> column of the <span style="color: #dd1c77;">Git</span> tab means that these are not currently in your GitHub repository.</p>
<p><img src="images/a.png" width="100%" style="display: block; margin: auto;" /></p>
<p>So let’s push them up to GitHub! Check the boxes next to all of the files, the scripts, the functions, and invisible <code>.gitignore</code> file and even the RStudio project file. Then click <span style="color: #dd1c77;">Commit</span>.</p>
<p><img src="images/b.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Write a suitably descriptive message and <span style="color: #dd1c77;">Commit</span> the files.</p>
<p><img src="images/c.png" width="100%" style="display: block; margin: auto;" /></p>
<p>A new window should open with a summary of your actions, stating your commit message and telling you that 11 files changed and 513 insertions were made.</p>
<p><img src="images/d.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Now go to your GitHub repository. Are the files there? What did we forget to do? Don’t forget that pressing <span style="color: #dd1c77;">Commit</span> isn’t enough. When you commit your files, you’re packaging them up ready to go. You still have to <span style="color: #dd1c77;">Push</span> them to GitHub. Do that now and make sure they appear in your repository.</p>
<p><img src="images/e.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-a-clean-start" class="section level2">
<h2>A clean start</h2>
<p>Sometimes you can find that something you have done before in R can interfere with what you are now doing – though if you’ve written all of your code correctly, then obviously(!) this should never happen. It is useful then to know that you can clear what is held in R’s memory using <code>rm(list = ls())</code>. This will cause all of the variables and functions in your <strong>global environment</strong> to disappear (<em>e.g.</em> if you type <code>human.annual.growth</code> in the R console it should tell you that the object is “not found”). As a fundamental rule however:</p>
<blockquote>
<p>you should never hardcode <code>rm(list = ls())</code> into any of your scripts and we recommend that you never use it at all.</p>
</blockquote>
<p>It’s generally a sign your code isn’t written well if it can be affected by something before it. Instead, you can clear your workspace by clicking the brush in the <span style="color: #dd1c77;">Environment</span> tab in RStudio (or <span style="color: #dd1c77;">Session &gt; Clear Workspace…</span> in the menus).</p>
<p>However, generally it’s easier to Restart R. This is much safer and more final. You can do it in RStudio via <span style="color: #dd1c77;">Session &gt; Restart R</span> in the menus: it is far more effective than clearing just the workspace as it resets everything, while leaving RStudio itself unaffected. Remember that once you have done this you may have to set the working directory to the correct folder, and you will certainly have to start running your code again completely from the beginning.</p>
<p>Note that, when you generate a report from the script file, they are always generated from a new, clean, version of R. So this is a very important final check that all of your code is working correctly – it’s as if you did restart R without actually wiping everything in your current R console - but only if you read it and check it looks right!</p>
<p>The other check we strongly encourage you to do is to check that your function does not use any global variables by using <code>findGlobals()</code>.</p>
<p>You should also generate a report for any function files you create. If you want to, you can put the <code>findGlobals()</code> check into this function file (which will run the check when you generate the report for that file) so it doesn’t clutter up the main script itself. But this is only useful if you generate a report from the function file! To solve this, you can make it so the report will fail to generate for that script when global variables are used with the following code snippets:</p>
<pre class="r"><code># Now check that function doesn&#39;t have any global variables.
library(codetools)
globals &lt;- findGlobals(step_simple_growth, merge = FALSE)$variables 
if (length(globals) != 0) {
  stop(&quot;Function step_simple_growth() may not use global variable(s): &quot;, globals)
}</code></pre>
</div>
<div id="section-tasks" class="section level2">
<h2>Tasks</h2>
<p>In this practical, we are going to demonstrate why it’s worth dividing up the code into separate functions, and indeed separate files. Previously we wrote a simple growth model, and a model of birth and death. We’re now going to use the two-step functions we created and run both models in a new script that compares them. For this final part of Practical 1, we’re going to generate a report in RStudio using everything we’ve learned so far.</p>
<p>Remember again that our first model of simple population growth model looks like this:</p>
<p><span class="math display">\[N(t+1) = N(t) + \lambda \times N(t)\]</span></p>
<p>The birth and death model is slightly more complex:</p>
<p><span class="math display">\[ N(t+1) = N(t) + b \times N(t) - d \times N(t)\]</span></p>
<p>In RStudio, open <span style="color: #dd1c77;">0106-report.R</span>. This script contains the beginnings of the analysis described above. At the top of the script we have used <code>source()</code> on <span style="color: #dd1c77;">0104-step-growth.R</span> and <span style="color: #dd1c77;">0105-step-birth-death.R</span> to add the <code>step_deterministic_growth()</code> and <code>step_deterministic_birth_death()</code> functions to our global environment. To illustrate this, open the <span style="color: #dd1c77;">Environment</span> tab in RStudio and make sure your workspace is empty. Now run line 12 in <span style="color: #dd1c77;">0106-report.R</span>:</p>
<pre class="r"><code>source(&quot;0104-step-growth.R&quot;)
```

You should see that the `step_deterministic_growth()` function has been added
to your workspace. When we invoke `source()` we are effectively running the 
contents of the file, which is a useful way to preload functions into our 
global environment.

We want to compare the models, so we have written some code that first runs a 
simulation with one model and plots it, and then runs a simulation with the 
other model and plots that as well. Remember that you can plot a second 
(or third, etc.) result on top of a first with commands like:</code></pre>
<pre class="r"><code>plot_populations(population.a, col = &quot;black&quot;)
plot_populations(population.b, new.graph = FALSE, col = &quot;red&quot;)
```

## Report

For this report, we want something clear and well laid out. You can see
an example of most of the possible formatting options in 
&lt;span style=&quot;color: #dd1c77;&quot;&gt;0106-example-notebook.R&lt;/span&gt;. Use an 
understanding of what you want to describe --
and formatting from the example file or elsewhere -- to break up your script so 
that your code and the results and figures are interspersed with a reasonable
explanation of what is going on.

Your report currently contains:

1. The birth-death model with a single given birth and death rate
2. The simple growth model with the birth rate as the growth rate

Extend your report to include:

3. The simple growth model with minus the death rate as the (negative) growth
   rate
4. The simple growth model with the difference (between the rates in 1) as the 
   growth rate

---

When you try to run your code you should find that the graphs are very likely on
different scales. You can set the y-axis limits of the second graph to the same 
as the first by reading off what they are on the first graph, and then plotting
the second as follows:</code></pre>
<pre class="r"><code>plot_populations(population.df, ylim = c(0, 20000000000))
```

Once you&#39;ve done this it should be easier to compare the two (by eye at least).

## Sharing is caring

Now we&#39;re going to try and share our work. To make it a little more interesting,
edit your `README.md` file. Write a sentence or two about yourself and what you
hope to get out of this course. Commit your changes and push them to GitHub.
Then look at your GitHub repository and make sure you can see your changes. 

To share your work, since you created a private (rather than a public) 
repository, you need to give people permission to see it. So, click on 
&lt;span style=&quot;color: #dd1c77;&quot;&gt;Settings&lt;/span&gt;, 
&lt;span style=&quot;color: #dd1c77;&quot;&gt;Manage access&lt;/span&gt;, then 
&lt;span style=&quot;color: #dd1c77;&quot;&gt;Invite teams or people&lt;/span&gt;.</code></pre>
<pre><code>## Error: attempt to use zero-length variable name</code></pre>
<pre><code>## Error: attempt to use zero-length variable name</code></pre>
<pre><code>## Error: attempt to use zero-length variable name</code></pre>
<pre><code>## Error: attempt to use zero-length variable name</code></pre>
<pre><code>## Error: attempt to use zero-length variable name</code></pre>
<pre><code>## Error: attempt to use zero-length variable name</code></pre>
<pre><code>## Error: attempt to use zero-length variable name</code></pre>

<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
tutorial_options(exercise.reveal_solution = FALSE)
gradethis::gradethis_setup()
 
knitr::opts_chunk$set(error = TRUE)
set.seed(123)
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83]}},"value":[{"type":"character","attributes":{},"value":["backports","base","bslib","cachem","callr","checkmate","cli","codetools","colorspace","compiler","crayon","curl","datasets","desc","deSolve","devtools","digest","dplyr","ellipsis","evaluate","fansi","fastmap","fs","generics","ggplot2","glue","gradethis","graphics","grDevices","grid","gtable","highr","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","learnr","lifecycle","magrittr","markdown","memoise","methods","mime","munsell","pillar","pkgbuild","pkgconfig","pkgload","prettyunits","processx","promises","ps","purrr","R6","Rcpp","remotes","rlang","rmarkdown","RPiR","rprojroot","rstudioapi","sass","scales","sessioninfo","shiny","stats","stringi","stringr","testthat","tibble","tidyselect","tools","usethis","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.3.0","4.1.2","0.3.1","1.0.6","3.7.0","2.0.0","3.1.0","0.2-18","2.0-2","4.1.2","1.4.2","4.3.2","4.1.2","1.4.0","1.30","2.4.2","0.6.28","1.0.7","0.3.2","0.14","0.5.0","1.1.0","1.5.0","0.1.1","3.3.5","1.4.2","0.2.4.9000","4.1.2","4.1.2","4.1.2","0.3.0","0.9","0.5.2","1.5.4","1.6.3","0.1.4","1.7.2","1.36","1.3.0","0.10.1.9016","1.0.1","2.0.1","1.1","2.0.0","4.1.2","0.12","0.5.0","1.6.4","1.2.0","2.0.3","1.2.3","1.1.1","3.5.2","1.2.0.1","1.6.0","0.3.4","2.5.1","1.0.7","2.4.1","0.4.12","2.11","0.71.11","2.0.2","0.13","0.4.0","1.1.1","1.2.1","1.7.1","4.1.2","1.7.5","1.4.0","3.1.0","3.1.5","1.1.1","4.1.2","2.1.3","1.2.2","4.1.2","0.3.8","2.4.2","0.27","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
